RewriteEngine On

# --------------------------------------
# Redirect .php to clean URL (external)
# --------------------------------------
RewriteCond %{THE_REQUEST} \s/+(.+?)\.php[\s?] [NC]
RewriteRule ^ %1 [R=301,L]

# --------------------------------------
# Internally rewrite clean URL to .php
# --------------------------------------
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_FILENAME} !-f
RewriteRule ^(.+)$ $1.php [L]

# --------------------------------------
# Block direct access to .php files
# (EXCEPT internal rewrites)
# --------------------------------------
RewriteCond %{THE_REQUEST} \s/+.+\.php[\s?] [NC]
RewriteRule ^.+\.php$ - [F]
