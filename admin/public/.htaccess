RewriteEngine On

# --------------------------------------
# Redirect .php URLs to clean ones
# --------------------------------------
RewriteCond %{THE_REQUEST} \s/+(.+?)\.php[\s?] [NC]
RewriteRule ^ %1 [R=301,L]

# --------------------------------------
# Rewrite clean URLs internally to .php
# --------------------------------------
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^(.+)$ $1.php [L]

# --------------------------------------
# Block direct access to .php files
# (but allow internal rewrites)
# --------------------------------------
RewriteCond %{THE_REQUEST} \s/+.+\.php[\s?] [NC]
RewriteRule ^.+\.php$ - [F]
